I"õ-<blockquote>
  <p>Title : EfficientNet, Scalable and Efficient Object Detection</p>
</blockquote>

<blockquote>
  <p>Paper link : <a href="https://arxiv.org/abs/1911.09070">https://arxiv.org/abs/1911.09070</a></p>
</blockquote>

<blockquote>
  <p>Publised year : 3 Apr 2020</p>
</blockquote>

<blockquote>
  <p>keywords : Object Detection</p>
</blockquote>

<hr />

<blockquote>
  <p>In this paper, we systematically study neural network architecture design choices for object detection and propose several key optimizations to improve efficiency. First, we propose <strong>a weighted bi-directional feature pyramid network (BiFPN)</strong>, which allows easy and fast multi-scale feature fusion; Second, we propose <strong>a compound scaling method</strong> that uniformly scales the resolution, depth, and width for all backbone, feature network, and box/class prediction networks at the same time.</p>
</blockquote>

<p align="center"><img src="https://drive.google.com/uc?id=1DFwNw-nHL0A0Wzw7gCl_OT45Bi25yVFR" width="100%" height="100%" /></p>

<p><br /></p>
<h2 id="introduction">Introduction</h2>
<hr />
<ul>
  <li>EfficientDetì˜ ì €ìëŠ” EfficientNetì˜ ì €ì(Mingxing Tan)ì™€ ë™ì¼í•˜ë‹¤.</li>
  <li>EfficientNetì€ Image classificationì—ì„œ ë›°ì–´ë‚œ ì„±ëŠ¥í–¥ìƒì„ ë³´ì—¬ì£¼ì—ˆìœ¼ë©°, ë³¸ ë…¼ë¬¸ì—ì„œëŠ” EfficientNet ë„¤íŠ¸ì›Œí¬ ë° ê¸°ë²•ì„ object detectionì— ì ìš©í•˜ì—¬ ë§ˆì°¬ê°€ì§€ë¡œ íƒì›”í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.</li>
  <li>ê¸°ì¡´ì˜ Detectorë“¤ì€ accuracyê°€ ë†’ìœ¼ë©´, ì—°ì‚°ëŸ‰(FLOPS)ì´ ë§ì•˜ë‹¤. ë°˜ëŒ€ë¡œ ì—°ì‚°ëŸ‰ì´ ì ì–´ efficiencyê°€ ë†’ìœ¼ë©´, accuracyê°€ ë‚®ì€ ê²½í–¥ì´ ìˆì—ˆë‹¤.</li>
  <li>ë˜í•œ ê¸°ì¡´ ì—°êµ¬ë“¤ì€ íŠ¹ì • ë˜ëŠ” ì ì€ resourceì—ë§Œ ì´ˆì ì„ ë§ì¶”ì—ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì‘ì€ mobile deviceì—ì„œ datacenterê¹Œì§€ ë‹¤ë¥¸ íŠ¹ì„±ì˜ applicationì„ ê³ ë ¤í•˜ëŠ” ê²½ìš°ê°€ ë§ê¸° ë•Œë¬¸ì— resource íŠ¹ì„±ì„ ê³ ë ¤í•œ detectorë¥¼ ì„¤ê³„í•˜ê³ ì í•˜ì˜€ë‹¤.</li>
</ul>

<blockquote>
  <p>A natural question is: Is it possible to build a scalable detection architecture with both higher accuracy and better efficiency across a wide spectrum of resource constraints (e.g., from 3B to 300B FLOPs)?</p>
</blockquote>

<ul>
  <li>ë”°ë¼ì„œ ì €ìë“¤ì˜ ëª©í‘œëŠ” <span style="background-color:#BFFF00"> â€œë‹¤ì–‘í•œ ìŠ¤í™íŠ¸ëŸ¼ì˜ í™˜ê²½(ì£¼ë¡œ ë©”ëª¨ë¦¬ ìš©ëŸ‰)ì—ì„œ ì‚¬ìš©ìì˜ ì·¨ì§€ì— ë§ê²Œ ì¡°ì ˆì´ ê°€ëŠ¥í•˜ë©°, ë†’ì€ ì„±ëŠ¥ê³¼ íš¨ìœ¨ì„ ì§€ë‹Œ detection êµ¬ì¡° ì„¤ê³„â€</span> ì´ë‹¤.</li>
</ul>

<h3 id="challenge">Challenge</h3>
<ul>
  <li>feature fusionì—ì„œ ë§ì´ ì‚¬ìš©ë˜ëŠ” FPNì€ ë‹¤ì–‘í•œ ê°ì²´ í¬ê¸°ë¥¼ ì¡ëŠ”ë° íš¨ê³¼ì ì´ë‹¤. FPNì—ì„œëŠ” feature fusionì„ ëª¨ë‘ ë™ì¼í•œ ë¹„ì¤‘ìœ¼ë¡œ ê°€ì ¸ê°€ëŠ”ë°, ì‹¤ì œë¡œëŠ” featureë“¤ì´ ë‹¤ë¥¸ í•´ìƒë„ë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— ì¶œë ¥ì— ë™ë“±í•˜ê²Œ ê¸°ì—¬í•˜ì§€ ì•ŠëŠ”ë‹¤. <span style="color:#DF8B00"><script type="math/tex">\rightarrow</script> BiFPN</span></li>
  <li>Backbone ë„¤íŠ¸ì›Œí¬ì™€ box/class prediction ë„¤íŠ¸ì›Œí¬ë¥¼ ì ì ˆí•˜ê²Œ scalingí•´ì•¼ íš¨ìœ¨ì ì´ë©´ì„œ ë†’ì€ ì„±ëŠ¥ì„ ì´ëŒì–´ ë‚¼ ìˆ˜ ìˆë‹¤.  <span style="color:#DF8B00"><script type="math/tex">\rightarrow</script> compound scaling method</span></li>
</ul>

<p><br /></p>
<h2 id="bifpn">BiFPN</h2>
<hr />
<p align="center"><img src="https://drive.google.com/uc?id=1w5ksW1Pi1PPrVv-UH0oj7RvSk_P2coSM" width="100%" height="100%" /></p>

<h3 id="problem-formulation">Problem Formulation</h3>
<ul>
  <li>Object detectionì€ Classificationê³¼ ë‹¤ë¥´ê²Œ ê°ì²´ì˜ í¬ê¸°ê°€ ë‹¤ì–‘í•˜ë©°, ì´ë¥¼ ëª¨ë‘ íƒì§€í•´ì•¼ í•œë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤. ë”°ë¼ì„œ ë‹¤ì–‘í•œ í•´ìƒë„ì˜ featureì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì•¼í•˜ë©° ì´ë“¤ì„ íš¨ê³¼ì ìœ¼ë¡œ fusioní•˜ëŠ” ê²ƒ(multi-scale feature fusion)ì´ ì¤‘ìš”í•˜ë‹¤.</li>
  <li>Multi-scale featuresë¥¼ <script type="math/tex">\vec{P^{in}}=(\vec{P^{in}_{l_1}},\vec{P^{in}_{l_2}},\dots)</script>ë¡œ ì •ì˜í•  ë•Œ, <script type="math/tex">\vec{P^{in}_{l_i}}</script>ëŠ” level <script type="math/tex">l_i</script>ì—ì„œì˜ featureì´ë‹¤.</li>
  <li><span style="background-color:#BFFF00">ëª©í‘œëŠ” ì…ë ¥ featureë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìœµí•©í•˜ëŠ” <script type="math/tex">f</script>ë¥¼ ì°¾ëŠ” ê²ƒì´ë‹¤.</span> <script type="math/tex">\vec{P^{out}}=f(\vec{P^{in}})</script></li>
  <li><script type="math/tex">\vec{P^{in}_{l_i}}</script>ì˜ í•´ìƒë„ëŠ” ì…ë ¥ ì˜ìƒ í•´ìƒë„ì˜ <script type="math/tex">1/2^i</script>ì˜ ë°°ì´ë‹¤. ì˜ˆë¥¼ë“¤ë©´, ì…ë ¥ ì˜ìƒ í•´ìƒë„ê°€ <script type="math/tex">640\times640</script>ì¸ ê²½ìš°, level 3ì˜ featureëŠ” <script type="math/tex">80\times80 (=640/2^3)</script>ì˜ í•´ìƒë„ë¥¼ ê°–ëŠ”ë‹¤.</li>
</ul>

<h3 id="cross-scale-connections">Cross-Scale Connections</h3>
<p align="center"><img src="https://drive.google.com/uc?id=1tAv7xlPJoa5QT_EO9c1YetsntexNLGHd" width="70%" height="100%" /></p>
<ul>
  <li>Figure 2ì—ëŠ” ê¸°ì¡´ì˜ detectorë“¤ì´ feature fusionì„ ì–´ë–»ê²Œ í–‰í–ˆëŠ”ì§€ì— ëŒ€í•´ ë‚˜ì™€ìˆë‹¤.</li>
  <li><strong>FPN</strong> : top-down ë°©ì‹ìœ¼ë¡œ ìƒìœ„ ë ˆë²¨ì˜ featureê°€ í•˜ìœ„ ë ˆë²¨ì˜ featureì— ìœµí•©ë˜ëŠ” í˜•íƒœì´ë©°, ë‹¨ë°©í–¥ì´ë‹¤. ë‹¨ë°©í–¥ì´ê¸° ë•Œë¬¸ì— í•˜ìœ„ ë ˆë°¸ì˜ ì •ë³´ê°€ ìƒìœ„ ë ˆë²¨ì˜ featureë¡œ ì „ë‹¬ë˜ì§€ ì•ŠëŠ” ë‹¨ì ì´ ìˆë‹¤.</li>
  <li><strong>PANet</strong> : FPNì˜ ë‹¨ì ì„ ê°œì„ í•˜ê¸° ìœ„í•´ì„œ top-downë¿ë§Œì´ ì•„ë‹Œ, bottom-upìœ¼ë¡œë„ ì—°ê²°í•œë‹¤.</li>
  <li><strong>NAS-FPN</strong> : í•™ìŠµì„ í†µí•´ ìµœì ì˜ ì•„í‚¤í…ì³ë¥¼ êµ¬í˜„í•œë‹¤. í•˜ì§€ë§Œ ìˆ˜ì²œê°œì˜ GPUê°€ ìš”êµ¬ë˜ë©°, ë¶ˆê·œì¹™í•œ êµ¬ì¡°ë¡œ ìˆ˜ì •í•˜ê¸°ê°€ ì–´ë µë‹¤.</li>
  <li>
    <p>PANetì´ FPN, NAS-FPNì— ë¹„í•˜ì—¬ accuracyê°€ ë†’ì§€ë§Œ íŒŒë¼ë¯¸í„° ìˆ˜ì™€ ì—°ì‚°ëŸ‰ì´ ë§ë‹¤.</p>
  </li>
  <li>ì €ìë“¤ì€ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ë²•ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</li>
</ul>

<ol>
  <li>feature fusionì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ” ë…¸ë“œë¥¼ ì œê±° <span style="color:#DF6C00"><script type="math/tex">\rightarrow</script> ì˜í–¥ì´ ì ì€ ë…¸ë“œë¥¼ ì œê±°í•˜ì—¬ ì—°ì‚°ëŸ‰ ê°œì„ </span></li>
  <li>ë™ì¼ ë ˆë²¨ì—ì„œ ì…ë ¥ ë…¸ë“œì™€ ì¶œë ¥ ë…¸ë“œë¥¼ ì—°ê²°í•˜ëŠ” extra edgeë¥¼ ì¶”ê°€ <span style="color:#DF6C00"><script type="math/tex">\rightarrow</script> ì¶”ê°€ë¹„ìš©ì„ ì¹˜ë¥´ì§€ ì•Šê³  ë” ë§ì€ featureë¥¼ fusioní•˜ëŠ” íš¨ê³¼</span>
    <blockquote>
      <p>Third, unlike PANet that only has one top-down and one bottom-up path, we treat each bidirectional (top-down &amp; bottom-up) path as one feature network layer, and repeat the same layer multiple times to enable more high-level feature fusion.</p>
    </blockquote>
  </li>
  <li><span style="background-color:#BFFF00">ë” ë§ì€ ìƒìœ„ ë ˆë²¨ì˜ feature fusionì„ ìœ„í•´, ë ˆì´ì–´ë¥¼ ë°˜ë³µí•˜ì—¬ ì¶”ê°€</span> <span style="color:#DF8B00"><script type="math/tex">\rightarrow</script> í•œë²ˆì˜ top-down, bottom-up ì—°ê²°ë§Œ êµ¬í˜„ëœ PANetê³¼ ë‹¤ë¥´ê²Œ  bidirectional path(top-down &amp; bottom-up)ë¥¼ í•˜ë‚˜ì˜ feature network layerë¡œ ë³´ì•„, ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•˜ì—¬ ì¶”ê°€í•¨ìœ¼ë¡œì„œ ë” ë§ì€ feature fusionì´ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.</span></li>
</ol>

<h3 id="weighted-feature-fusion">Weighted Feature Fusion</h3>
<ul>
  <li>Featureë¥¼ fusingí•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì€, ê°ê¸° ë‹¤ë¥¸ í•´ìƒë„ì˜ featureë¥¼ bicubicê³¼ ê°™ì€ interpolationìœ¼ë¡œ resize í•œ í›„, ë”í•˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li>ê¸°ì¡´ì˜ feature fusing ë°©ë²•ë“¤ì€ ì…ë ¥ feature ë“¤ì„ ë™ë“±í•œ ë¹„ì¤‘ìœ¼ë¡œ fusion í•˜ì˜€ë‹¤. í•˜ì§€ë§Œ ì…ë ¥ feature ë“¤ì˜ í•´ìƒë„ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ì¼ë°˜ì ìœ¼ë¡œ ì¶œë ¥ featureì— ë‹¤ë¥¸ ë¹„ì¤‘ìœ¼ë¡œ ê¸°ì—¬í•˜ê²Œ ëœë‹¤.</li>
  <li>ì €ìë“¤ì€ ì´ì ì— ì°©ì•ˆí•˜ì—¬ <span style="background-color:#BFFF00">ì…ë ¥ feature ë“¤ì˜ ë¹„ì¤‘ì„ ë‚˜íƒ€ë‚´ëŠ” ê°’ì¸ weightë¥¼ ì •ì˜í•˜ê³ , ë„¤íŠ¸ì›Œí¬ê°€ ì…ë ¥ featureë“¤ì˜ ì¤‘ìš”ë„ë¥¼ í•™ìŠµí•˜ê²Œ ì„¤ê³„í•˜ì˜€ë‹¤.</span></li>
</ul>

<ol>
  <li>
    <dl>
      <dt>Unbounded Fusion</dt>
      <dd>
        <script type="math/tex; mode=display">O=\Sigma_iw_i\cdot I_i</script>
      </dd>
      <dd><script type="math/tex">\rightarrow</script> <script type="math/tex">w_i</script> : learnable weight, <script type="math/tex">I_i</script> : feature map</dd>
      <dd><script type="math/tex">\rightarrow</script> weightê°€ unbounded ë˜ì–´, í•™ìŠµì‹œ ë¶ˆì•ˆì •í•˜ê¸° ë•Œë¬¸ì— ì •ê·œí™”ê°€ í•„ìš”í•˜ë‹¤.</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt>Softmax-based fusion</dt>
      <dd>
        <script type="math/tex; mode=display">O=\Sigma_i \frac{e^{w_i}}{\Sigma_je^{w_j}} \cdot I_i</script>
      </dd>
      <dd><script type="math/tex">\rightarrow</script> ê° weightì— softmaxë¥¼ ì·¨í•˜ì—¬ ì •ê·œí™”í•œë‹¤.</dd>
      <dd><script type="math/tex">\rightarrow</script> ì™œ softmax ì¸ê°€? softmaxëŠ” <script type="math/tex">j</script>ê°œì˜ ê°’ì´ ì¡´ì¬í•˜ë©´, ê° ê°’ì˜ í¸ì°¨ë¥¼ í™•ëŒ€ì‹œì¼œ (í° ê°’ì€ ë” í¬ê²Œ, ì‘ì€ ê°’ì€ ë” ì‘ê²Œ) [0,1] ë²”ìœ„ì˜ ê°’ë“¤ë¡œ ì •ê·œí™”í•œë‹¤.</dd>
      <dd><script type="math/tex">\rightarrow</script> í•˜ì§€ë§Œ ë‹¨ìˆœíˆ Softmaxë¥¼ í•˜ê²Œ ë˜ë©´, GPUì—ì„œ ì—°ì‚° ì†ë„ê°€ ëŠë ¤ì§€ê²Œ ëœë‹¤. ë”°ë¼ì„œ ì—°ì‚°ì´ ë¹ ë¥¸ ë°©ë²•ì„ ê³ ì•ˆí•˜ê²Œ ë˜ì—ˆë‹¤.</dd>
    </dl>
  </li>
  <li>
    <dl>
      <dt><strong>Fast normalized fusion</strong></dt>
      <dd>
        <script type="math/tex; mode=display">O=\Sigma_i \frac{e^{w_i}}{\epsilon + \Sigma_je^{w_j}} \cdot I_i</script>
      </dd>
      <dd><script type="math/tex">\rightarrow</script> <script type="math/tex">w_i</script>ì— Reluë¥¼ ì·¨í•´ ì–‘ìˆ˜ê°€ ë˜ë„ë¡ í•œë‹¤. <script type="math/tex">\epsilon</script>ì€ 0.0001ê³¼ ê°™ì€ ì‘ì€ ìˆ˜ì¹˜ë¡œ ì •í•œë‹¤.</dd>
      <dd><script type="math/tex">\rightarrow</script> ì •ê·œí™”ëœ weightëŠ” 0ì—ì„œ 1ì‚¬ì´ ê°’ì„ ê°€ì§€ì§€ë§Œ, softmax ì—°ì‚°ì„ ì•ˆí•˜ë¯€ë¡œ ë” íš¨ìœ¨ì ì´ë‹¤.</dd>
      <dd>
        <p align="center"><img src="https://drive.google.com/uc?id=1PWABfKbTtz-Le2FBiJ-yjlQwKVKqXKB4" width="100%" height="100%" /></p>
      </dd>
      <dd><script type="math/tex">\rightarrow</script> ì‹¤í—˜ ê²°ê³¼ì—ì„œë„ Fast normalized fusionì˜ í•™ìŠµ ë°©ì‹ì´, Softmaxë¥¼ ì ìš©í•  ë•Œì™€ ë¹„ìŠ·í•œ í•™ìŠµ ì–‘ìƒì„ ë³´ì¸ë‹¤. ë˜í•œ ì—°ì‚° ì†ë„ë„ 1.3ë°° ì •ë„ ë¹¨ë¼ì§€ê²Œëœë‹¤.</dd>
      <dd>
        <p align="center"><img src="https://drive.google.com/uc?id=1TS2XsSWBRJpMqOD0gTiDYjvjl15Z3-rK" width="100%" height="100%" /></p>
      </dd>
      <dd><script type="math/tex">\rightarrow</script> BiFPNì„ ë„ì‹í™” í•˜ë©´ ìœ„ ê·¸ë¦¼ê³¼ ê°™ë‹¤. nodeëŠ” operationìœ¼ë¡œ edgeëŠ” feature mapìœ¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. ì‹¤ì œë¡œ ì €ìë“¤ì€ ë” ë†’ì€ íš¨ìœ¨ì ì¸ êµ¬ì¡°ë¥¼ ìœ„í•´ depthwise separable convolutionì„ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, conv ì—°ì‚°ë§ˆë‹¤ batch normalizationì„ ì ìš©í•˜ì˜€ë‹¤.</dd>
    </dl>
  </li>
</ol>

<p><br /></p>
<h2 id="efficientdet">EfficientDet</h2>
<hr />

<blockquote>
  <p>Aiming at optimizing both accuracy and efficiency, we would like to develop a family of models that can meet a wide spectrum of resource constraints. A key challenge here is how to scale up a baseline EfficientDet model.</p>
</blockquote>

<ul>
  <li>EffiicentDetì€ ë§ˆì°¬ê°€ì§€ë¡œ EfficientNetì˜ <strong>Compound Scaling</strong> ê¸°ë²•(<a href="https://llamakoo.github.io/blog/2020/04/17/EfficientNet/">EfficientNet ë…¼ë¬¸ ë¦¬ë·° ì°¸ê³ </a>)ì„ ì‚¬ìš©í•˜ì—¬ model scalingì„ í†µí•´ ë‹¤ì–‘í•œ í¬ê¸°ì˜ ëª¨ë¸ì„ êµ¬í˜„í•˜ì˜€ë‹¤.</li>
  <li>Networkì˜ width, depth, input resolutionì„ scalingí•˜ëŠ” ê²ƒì€ EfficientNetê³¼ ë™ì¼í•˜ì§€ë§Œ, scaling í•´ì•¼ í•  ë„¤íŠ¸ì›Œí¬(backbone network, BiFPN network, class/box network)ê°€ ë§ë‹¤.</li>
  <li>ë”°ë¼ì„œ ë„¤íŠ¸ì›Œí¬ë“¤ ì „ë¶€ì— ëŒ€í•´ì„œ grid searchë¡œ í•˜ë‚˜ì”© ì°¾ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë ¤ìš´ ì‘ì—…ì´ê¸° ë•Œë¬¸ì— heuristicí•œ ë°©ë²•ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.</li>
  <li>EfficientNetì˜ ëª¨ë¸(B0 ~ B6)ê³¼ ë™ì¼í•˜ê²Œ êµ¬ì„±í•˜ë©°,  BiFPN ë„¤íŠ¸ì›Œí¬ëŠ” <script type="math/tex">W_{biFPN}=64\cdot(1.35^\phi)</script></li>
</ul>
:ET